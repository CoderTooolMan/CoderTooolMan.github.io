---
layout: post
title: '高级运筹学大作业'
date: 2022-05-28 08:02:00 +0800
author: Toolman
---
## 作业思考

《高级运筹学》大作业，也是21年华为软挑赛题。

[赛题](\urls\or-work\VmScheduling.pdf)

主要分为服务器购买、虚拟机部署和迁移问题

需要考虑cpu和mem两个维度

### 购买策略

1.硬件成本。贪心策略，按硬件成本升序排序。购买能放下虚拟机的最便宜的服务器。

2.服务器性价比。按硬件成本/（cpu+内存数）升序排序，购买性价比最高的服务器。没有优化。

3.能源成本。按单日能源成本升序排序，购买能放下虚拟机的每日能源成本最低的服务器。没有优化。

### 部署策略

1.优先填满服务器。选择部署后剩余空间最小的服务器。

2.平衡部署。对于部署后的服务器，若一种资源剩余量远小于另一种资源（剩余资源>10且一种资源是另一种的k倍以上，或一种资源为0另一种在m以上），认为部署不均衡，设置惩罚函数：
$$
资源剩余量=k*剩余资源量   （剩余资源>10且一种资源是另一种的k倍以上）
$$

$$
资源剩余量=am            （一种资源为0另一种在m以上）
$$

取资源剩余量最小的服务器进行部署。调整参数k、a、m，没有得到能优化的解。

3.设置空闲资源。分析原有结果，发现硬件成本最低且容量较小的服务器(host1V93K)占比接近60%，后期该服务器无法放下大需求的虚拟机，因此闲置，造成较大硬件成本。考虑部署过程中强行留出部分剩余空间，来购买大容量服务器。调参设置留出1%、5%、10%，均没有优化。

4.调整部署顺序。题目一次性输入所有请求，因此对于每天的请求序列，可以调整部署顺序来解决上一条的问题。以每一条删除请求为分界线，先部署资源需求大的虚拟机，再部署需求较小的。有较大优化。但是大大增加了运行时间。最后决定每5天/10天调整一次。

5.再次调整部署顺序。在上一条基础上，考虑先执行所有删除操作，再执行添加操作，这样可以显著降低闲置率。但是离线判题器的运行逻辑是按原请求顺序每次操作后判断可行性，因此无法通过。考虑实际情况，已知所有需求后再操作，降低了服务的时效性，不太合理。

### 迁移策略

1.服务器上虚拟机数。将虚拟机数为1的服务器进行迁移处理，关闭部分服务器来降低能源成本。有优化。

2.服务器的负载率。将服务器按负载量升序排序，优先迁移负载量低的服务器，降低能源成本。有优化。

3.服务器的虚拟机数和能源成本。将服务器先按虚拟机数再按能源成本这两个字段升序排序，在虚拟机数相等的情况下优先迁移能源成本高的服务器。没有优化。

4.硬件成本。考虑到多个小虚拟机迁移合并后可能占据大服务器，导致新的大虚拟机请求无法部署。因此设置虚拟机迁移只能迁移到同种服务器上。有优化。

### 判题器的结果

[Report](\urls\or-work\report.html)

### 代码

[Code](\urls\or-work\code)

### 收获

第一眼看到老师给的baseline程序时，感到非常庞大和茫然。分步执行几遍后逐渐熟悉了数据结构和运行逻辑，并制作了变量列表帮助理解。在处理这样大型的问题上积累了一点经验。

想到的一些优化策略只是感觉上有用，实际编程后并不能优化。多次尝试策略或者调参，有时也只能优化一点点或者没有优化。但是目前给不出为什么可以/不可以优化的证明。

可能可以使用局部搜索或者启发式算法？没有想到好的策略，且数据集较大可能会出现超时。

按照readme使用离线判题器，运行失败，出现了没有列出的bug，花了很久才找到原因并解决。优化过程中出现未知问题，阅读判题器的源代码，学习过一些python，修改判题器找到并输出了问题原因。